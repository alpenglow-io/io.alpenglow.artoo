package re.artoo.lance.query.cursor.operation;

import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import re.artoo.lance.query.cursor.Fetch;

import static org.assertj.core.api.Assertions.assertThat;
import static org.junit.jupiter.api.Assertions.assertThrows;

class OpenTest {
  @Test
  @DisplayName("should next all values until none")
  void shouldOpenValidValuesOnly() throws Throwable {
    var open = new Open<>("Luke", null, "I'm", "your", null, "father", null, null, null, "fool!");

    assertThat(open.next()).isEqualTo("Luke");
    assertThat(open.next()).isEqualTo(null);
    assertThat(open.next()).isEqualTo("I'm");
    assertThat(open.next()).isEqualTo("your");
    assertThat(open.next()).isEqualTo(null);
    assertThat(open.next()).isEqualTo("father");
    assertThat(open.next()).isEqualTo(null);
    assertThat(open.next()).isEqualTo(null);
    assertThat(open.next()).isEqualTo(null);
    assertThat(open.next()).isEqualTo("fool!");
    assertThat(open.hasNext()).isFalse();
  }

  @Test
  @DisplayName("should throw an exception on an open empty cursor")
  void shouldThrowAnExceptionOnEmptyCursor() {
    var open = new Open<>();

    assertThrows(Fetch.Exception.class, open::next);
  }
}
